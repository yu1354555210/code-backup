(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/task/task"],{"0e3a":function(t,n,o){"use strict";o.d(n,"b",(function(){return i})),o.d(n,"c",(function(){return a})),o.d(n,"a",(function(){return e}));var e={countdownTimer:function(){return o.e("components/countdown-timer/countdown-timer").then(o.bind(null,"e230"))}},i=function(){var t=this,n=t.$createElement,o=(t._self._c,t.__map(t.dataList,(function(n,o){var e=t.__get_orig(n),i="签到"==n.name?t.statusInfo(n.status):null,a="邀请好友"==n.name&&t.getLoginStatus?t.statusInfo(n.status):null,s="邀请好友"!=n.name||t.getLoginStatus?null:t.statusInfo(n.status),u="分享群聊"==n.name&&1==n.status?t.statusInfo(n.status):null,c="分享群聊"==n.name&&1!=n.status?t.statusInfo(n.status):null;return{$orig:e,m0:i,m1:a,m2:s,m3:u,m4:c}})));t._isMounted||(t.e0=function(n){t.setDialogStatus(),t.dialogType=1},t.e1=function(n){t.inviteStatus=!0},t.e2=function(n){t.shareStatus=!0}),t.$mp.data=Object.assign({},{$root:{l0:o}})},a=[]},2692:function(t,n,o){},"639b":function(t,n,o){"use strict";var e=o("2692"),i=o.n(e);i.a},"6bda":function(t,n,o){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=o("2f62");function i(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),o.push.apply(o,e)}return o}function a(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?i(Object(o),!0).forEach((function(n){s(t,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))}))}return t}function s(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}var u=function(){o.e("components/vDialog").then(function(){return resolve(o("8fe0"))}.bind(null,o)).catch(o.oe)},c={data:function(){return{dialogType:0,videoNum:0,imgList:10,totalNum:0,dataList:"",bonus:"",isShowToast:!1,isCountDown:!1,time:15,videoBtnStatus:!1,shareStatus:!1,inviteStatus:!1,timer:null,taskName:"",videoAd:null,subStatus:1}},onLoad:function(){this.$utils.videoAdInit("adunit-ac3122f99ef897e2")},onShow:function(){var t=this;this.getLoginStatus?this.inviteStatus&&(this.timer=setInterval((function(){t.getInviteStatus()}),1e4)):this.setLoginDialogStatus(),this.shareStatus&&(this.shareStatus=!1,this.tellFriend()),this.inviteStatus&&(this.inviteStatus=!1),this.getTaskData()},mounted:function(){this.$nextTick((function(){var t=this;setTimeout((function(){t.getTaskData((function(){t.countTime()}))}),30)}))},computed:a(a(a({},(0,e.mapGetters)(["getDialogStatus","token","getLoginStatus","getInfo"])),(0,e.mapState)(["loginDialogStatus"])),{},{getTime:function(){var t=parseInt(1e3*this.time);return t}}),components:{vDialog:u},onShareAppMessage:function(t){return t.from,{title:"天天领红包",imageUrl:"https://app1-api.qianr.com/static/bonus/share.png",path:"/pages/index/index?inviteCode=".concat(this.getInfo.invite_code)}},watch:{getLoginStatus:function(t,n){var o=this;t&&this.getTaskData((function(){o.countTime()}))}},methods:a(a({},(0,e.mapMutations)(["setDialogStatus","setLoginDialogStatus"])),{},{showToast:function(){var t=this;this.isShowToast=!0,setTimeout((function(){t.isShowToast=!1}),2e3)},statusInfo:function(t){return 1==t?"未完成":"已完成"},signIn:function(n){var o=this,e="VNmGHIB7BZVQ8trb1kr0BIvlPOj3AS99Y-NHsPjInxk";this.checkLogin((function(){1==n?2==o.subStatus?t.requestSubscribeMessage({tmplIds:[e],success:function(n){o.showVideoAd((function(){o.getSignInData()})),"accept"===n[e]&&(o.postSubscribe(),t.showToast({icon:"none",title:"订阅成功"}))}}):o.showVideoAd((function(){o.getSignInData()})):o.getSignInData()}))},postSubscribe:function(){this.$http.post("/api/bonus/v1/subscribe",{token:this.token}).then((function(t){})).catch((function(n){t.showToast({icon:"none",title:"系统错误，请稍后重试"})}))},getSignInData:function(){var n=this;this.$http.post("/api/bonus/v1/sign_in",{token:this.token}).then((function(o){if(200==o.data.status){var e=o.data.data;n.bonus=e.bonus,n.taskName="签到",n.showToast(),n.getTaskData()}else t.showToast({icon:"none",title:o.data.msg})})).catch((function(n){t.showToast({icon:"none",title:"系统错误，请稍后重试"})}))},showVideoAd:function(n){var o=this;t.showLoading({title:"广告加载中"}),this.$utils.videoAdShow((function(){t.hideLoading(),(o.videoNum+1)%5==0&&t.showToast({icon:"none",duration:2e4,title:"点击下方按钮，可能触发惊喜"})})).then((function(t){t?n&&n():console.log("失败了")})).catch((function(n){t.hideLoading(),t.showToast({icon:"none",title:"视频加载失败了,稍后再试"})}))},shareDialog:function(){var t=this;this.checkLogin((function(){t.setDialogStatus(),t.dialogType=2}))},inviteShare:function(){this.checkLogin()},tellFriend:function(){var n=this;this.$http.post("/api/bonus/v1/tell_friend",{token:this.token}).then((function(o){if(200==o.data.status){var e=o.data.data;n.bonus=e.bonus,n.taskName="告诉朋友们",n.showToast(),n.getTaskData()}else t.showToast({icon:"none",title:o.data.msg})})).catch((function(n){t.showToast({icon:"none",title:"系统错误，请稍后重试"})}))},watchVideo:function(){var n=this;this.$http.post("/api/bonus/v1/watch_video",{token:this.token}).then((function(o){if(200==o.data.status){var e=o.data.data;n.videoNum=e.num,e.bonus>0&&(n.bonus=e.bonus,n.taskName="看视频",n.showToast(),n.getTaskData()),10===n.videoNum?(n.videoBtnStatus=!0,n.isCountDown=!1,n.$refs.countdown.reset()):(n.toggleCountDown(),n.$refs.countdown.start())}else t.showToast({icon:"none",title:o.data.msg})})).catch((function(n){t.showToast({icon:"none",title:"系统错误，请稍后重试"})}))},onFinish:function(){this.countTime(),this.toggleCountDown()},tapVideoAd:function(){var n=this;this.checkLogin((function(){10!==n.videoNum?n.showVideoAd((function(){n.watchVideo()})):t.showToast({icon:"none",title:"今日任务已完成"})}))},toggleCountDown:function(){this.isCountDown=!this.isCountDown},countTime:function(){return this.time=15+5*this.videoNum},getTaskData:function(n){var o=this;this.$http.get("/api/bonus/v1/task",{params:{token:this.token}}).then((function(e){if(200==e.data.status){var i=e.data.data;o.totalNum=i.total,o.videoNum=i.video_num,o.dataList=i.info,o.subStatus=i.sub_status,n&&n()}else t.showToast({icon:"none",title:e.data.msg})})).catch((function(n){t.showToast({icon:"none",title:"系统错误，请稍后重试"})}))},getInviteStatus:function(){var n=this;this.$http.get("/api/bonus/v1/get_status",{params:{token:this.token}}).then((function(o){if(200==o.data.status){var e=o.data.data;e.num>0&&(n.bonus=e.num,n.taskName="新用户助力",n.showToast(),n.getTaskData(),clearInterval(n.timer))}else t.showToast({icon:"none",title:o.data.msg})})).catch((function(n){t.showToast({icon:"none",title:"系统错误，请稍后重试"})}))}}),onHide:function(){this.setDialogStatus(!1),this.dialogType=0,clearInterval(this.timer)}};n.default=c}).call(this,o("543d")["default"])},b21a:function(t,n,o){"use strict";(function(t){o("c4f9");e(o("66fd"));var n=e(o("d519"));function e(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,o("543d")["createPage"])},d519:function(t,n,o){"use strict";o.r(n);var e=o("0e3a"),i=o("df43");for(var a in i)"default"!==a&&function(t){o.d(n,t,(function(){return i[t]}))}(a);o("639b");var s,u=o("f0c5"),c=Object(u["a"])(i["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],s);n["default"]=c.exports},df43:function(t,n,o){"use strict";o.r(n);var e=o("6bda"),i=o.n(e);for(var a in e)"default"!==a&&function(t){o.d(n,t,(function(){return e[t]}))}(a);n["default"]=i.a}},[["b21a","common/runtime","common/vendor"]]]);